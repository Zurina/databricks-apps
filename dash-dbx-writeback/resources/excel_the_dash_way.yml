resources:
  apps:
    excel_the_dash_way:
      name: excel-the-dash-way
      description: An example of Dash AG-Grid for sophisticated write-backs
      source_code_path: ../
      resources:
        - sql_warehouse:
            id: 148ccb90800933a1
            permission: CAN_USE
          name: sql-warehouse
        - database:
            database_name: ${var.database}
            instance_name: ${var.instance_name}
            permission: CAN_CONNECT_AND_CREATE
          name: postgres-database 


  volumes:
    dash_dbx_writeback_volume:
      catalog_name: ${var.catalog}
      name: ${var.schema}
      schema_name: ${var.schema}
      grants:
        - principal: ${resources.apps.excel_the_dash_way.service_principal_client_id}
          privileges:
            - WRITE_VOLUME
            - READ_VOLUME
            - APPLY_TAG
        - principal: ${workspace.current_user.userName} 
          privileges:
            - WRITE_VOLUME
            - READ_VOLUME
            - APPLY_TAG
  
  schemas:
    dash_dbx_writeback_schema:
      name: ${var.schema}
      catalog_name: ${var.catalog}
      comment: This schema was created by Databricks Asset Bundles.
      grants:
        - principal: ${resources.apps.excel_the_dash_way.service_principal_client_id}
          privileges:
            - CREATE_TABLE
            - EXECUTE
            - SELECT
            - MODIFY
            - REFRESH
            - WRITE_VOLUME
            - READ_VOLUME
            - APPLY_TAG
            - USE_SCHEMA
        - principal: ${workspace.current_user.userName} 
          privileges:
            - CREATE_TABLE
            - EXECUTE
            - SELECT
            - MODIFY
            - REFRESH
            - WRITE_VOLUME
            - READ_VOLUME
            - APPLY_TAG
            - USE_SCHEMA 

